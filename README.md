#CREATE<br>
CREATE TABLE SALESMAN<br>
(SALESMAN_ID INT,<br>
NAME VARCHAR (20),<br>
CITY VARCHAR (20),<br>
COMMISSION VARCHAR (20),<br>
PRIMARY KEY (SALESMAN_ID));<br>
<br>
CREATE TABLE CUSTOMER<br>
(CUSTOMER_ID INT,<br>
CUST_NAME VARCHAR (20),<br>
CITY VARCHAR(20),<br>
GRADE INT (3) NOT NULL CHECK(GRADE <= 10),<br>
SALESMAN_ID INT,<br>
PRIMARY KEY (CUSTOMER_ID),<br>
FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN (SALESMAN_ID) ON DELETE CASCADE);<br>
<br>
CREATE TABLE ORDERS<br>
(ORD_NO INT,<br>
PURCHASE_AMT INT NOT NULL,<br>
ORD_DATE DATE NOT NULL,<br>
SALESMAN_ID INT,<br>
CUSTOMER_ID INT,<br>
PRIMARY KEY (ORD_NO),<br>
FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID) ON DELETE CASCADE,<br>
FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN (SALESMAN_ID) ON DELETE CASCADE);<br>
<br>
<br>
#Description of Tables<br>
DESC SALESMAN;<br>
DESC CUSTOMER;<br>
DESC ORDERS;<br>
<br>
<br>
#INSERT<br>
INSERT INTO SALESMAN VALUES (1000, 'JOHN','BANGALORE','25 %');<br>
INSERT INTO SALESMAN VALUES (2000, 'RAVI','BANGALORE','20 %');<br>
INSERT INTO SALESMAN VALUES (3000, 'KUMAR','MYSORE','15 %');<br>
INSERT INTO SALESMAN VALUES (4000, 'SMITH','DELHI','30 %');<br>
INSERT INTO SALESMAN VALUES (5000, 'HARSHA','HYDRABAD','15 %');<br>
<br>
INSERT INTO CUSTOMER VALUES (10, 'PREETHI','BANGALORE', 8.5, 4000);<br>
INSERT INTO CUSTOMER VALUES (11, 'VIVEK','MANGALORE', 4.5, 1000);<br>
INSERT INTO CUSTOMER VALUES (12, 'BHASKAR','CHENNAI', 7.5, 2000);<br>
INSERT INTO CUSTOMER VALUES (13, 'CHETHAN','BANGALORE', 6, 2000);<br>
INSERT INTO CUSTOMER VALUES (14, 'MAMATHA','BANGALORE', 2.4, 3000);<br>
<br>
INSERT INTO ORDERS VALUES (50, 5000, '2017-5-1', 1000, 10);<br>
INSERT INTO ORDERS VALUES (51, 450, '2017-01-27', 2000, 10);<br>
INSERT INTO ORDERS VALUES (52, 1000, '2017-02-24', 2000, 13);<br>
INSERT INTO ORDERS VALUES (53, 3500, '2017-04-23', 3000, 14);<br>
INSERT INTO ORDERS VALUES (54, 550, '2017-03-13', 2000, 12);<br>
<br>
<br>
<br>

#QUERIES<br>

1.	Count the customers with grades above Bangalore‟s average.<br>
SELECT COUNT(CUSTOMER_ID) FROM CUSTOMER WHERE GRADE > (SELECT AVG(GRADE) FROM CUSTOMER WHERE CITY='BANGALORE');<br>
<br>
2.	Find the name and numbers of all salesman who had more than one customer.<br>
SELECT SALESMAN_ID,NAME FROM SALESMAN A WHERE (SELECT COUNT(*) FROM CUSTOMER C WHERE C.SALESMAN_ID=A.SALESMAN_ID) > 1;<br>
<br>
3.	List all the salesman and indicate those who have and don‟t have customers in their cities (Use UNION operation.)<br>
SELECT SALESMAN.SALESMAN_ID, NAME,CUST_NAME,COMMISSION FROM SALESMAN,CUSTOMER WHERE SALESMAN.CITY=CUSTOMER.CITY UNION SELECT SALESMAN_ID,NAME,'NO MATCH',COMMISSION FROM SALESMAN WHERE NOT SALESMAN.CITY IN (SELECT CUSTOMER.CITY FROM CUSTOMER)<br>
ORDER by SALESMAN_ID;<br>
<br>
4.	Create a view that finds the salesman who has the customer with the highest order of a day.<br>
CREATE VIEW HighestOrder AS SELECT s.SALESMAN_ID, s.NAME, o.ORD_DATE, o.PURCHASE_AMT FROM SALESMAN s, ORDERS o WHERE (o.SALESMAN_ID = s.SALESMAN_ID) and  o.PURCHASE_AMT = (SELECT MAX(PURCHASE_AMT) FROM ORDERS);<br>
SELECT * FROM HighestOrder;<br>
<br>
5.	Demonstrate the DELETE operation by removing salesman with id 1000. All his orders must also be deleted.<br>
DELETE FROM SALESMAN WHERE SALESMAN_ID=1000;<br>
SELECT * FROM SALESMAN;<br>
SELECT * FROM ORDERS;<br>

